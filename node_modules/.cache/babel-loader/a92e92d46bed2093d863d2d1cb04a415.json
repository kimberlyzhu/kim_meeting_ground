{"ast":null,"code":"var _jsxFileName = \"/Users/kimberlyzhu/Documents/MeetingGround/src/calendar/connect.tsx\";\nimport React, { useState, useEffect } from \"react\";\nimport * as config from \"../apiGoogleconfig.json\";\nimport moment from \"moment\";\nimport MyCalendar from \"../pages/Moment\";\nimport styled from \"@emotion/styled\";\nimport \"react-big-calendar/lib/css/react-big-calendar.css\";\nimport logo from \"../pages/img/meetingGroundLogo.png\";\nimport { Link } from \"react-router-dom\";\nimport { useMutation } from \"react-apollo\";\nimport { gql } from \"apollo-boost\"; //yarn add @types/gapi\n//yarn add @types/gapi.auth2\n//yarn add @types/gapi.client.calendar\n\nconst AppendHostToDB = gql`\n  mutation addHost(\n    $fname: String!\n    $lname: String!\n    $email: String!\n    $auth_code: String!\n  ) {\n    addHost(\n      Fname: $fname\n      Lname: $lname\n      email: $email\n      auth_code: $auth_code\n    ) {\n      Lname\n      email\n    }\n  }\n`;\n\nconst ConnectPage = () => {\n  const [isSigned, setIsSigned] = useState(false);\n  const [name, setName] = useState(\"\");\n  const [picUrl, setPicUrl] = useState(\"\");\n  const [refreshToken, setRefreshToken] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [fname, setFname] = useState(\"\");\n  const [lname, setLname] = useState(\"\");\n  const [auth_code, setAuthcode] = useState(\"\"); //user Google Offline Access code\n\n  const [message, setMessage] = useState(\"\");\n  const [myEvents, setMyEvents] = useState([]);\n  const [authorizeButton, setAuthorizeButton] = useState(\"\");\n  const [signoutButton, setSignoutButton] = useState(\"\");\n  const [mutate] = useMutation(AppendHostToDB);\n  useEffect(() => {\n    async function addHostToDb() {\n      // auth_code --> Google Offline Access code\n      const arg = await mutate({\n        variables: {\n          fname: fname,\n          lname: lname,\n          email: email,\n          auth_code: auth_code\n        }\n      });\n      console.log(arg);\n    }\n\n    if (auth_code && fname && lname && email) {\n      addHostToDb().then(() => {\n        console.log(\"appended successfully\");\n      }).catch(err => {\n        console.log(\"an error happened\");\n      });\n    }\n  }, [auth_code, fname, lname, email, mutate]);\n  /**\n   *  On load, called to load the auth2 library and API client library.\n   */\n\n  useEffect(() => {\n    gapi.load(\"client:auth2\", initClient);\n  }, []); // --> [] call the function only one time at the beginning\n  // function handleClientLoad() {\n  //   gapi.load(\"client:auth2\", initClient);\n  // }\n\n  /**\n   *  Initializes the API client library and sets up sign-in state\n   *  listeners.\n   */\n\n  function initClient() {\n    gapi.client.init({\n      apiKey: config.config.apiKey,\n      clientId: config.config.clientId,\n      discoveryDocs: config.config.discoveryDocs,\n      scope: config.config.scope\n    }).then(function () {\n      // Listen for sign-in state changes.\n      gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus); // Handle the initial sign-in state.\n\n      updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get()); //authorizeButton.onclick = handleAuthClick;\n      //signoutButton.onclick = handleSignoutClick;\n    }, function (error) {\n      // setMessage(JSON.stringify(error, null, 2));\n      // const temp: string = JSON.stringify(error, null, 2);\n      // message += temp;\n      appendPre(JSON.stringify(error, null, 2));\n    });\n  } //get refresh tokens\n  // const getRefreshTokenFromGoogleServices = (authCode: any) => {\n  //   return new Promise((resolve, reject) => {\n  //     var jsonRequest = {\n  //       client_id: config.config.clientId,\n  //       client_secret: config.config.clientSecret,\n  //       code: authCode,\n  //       grant_type: \"authorization_code\",\n  //       redirect_uri: \"postmessage\",\n  //     };\n  //     console.log(jsonRequest);\n  //     request(\n  //       {\n  //         url: \"https://accounts.google.com/o/oauth2/token\",\n  //         method: \"POST\",\n  //         headers: [{ name: \"Content-Type\", value: \"application/json\" }],\n  //         body: jsonRequest,\n  //         json: true,\n  //       },\n  //       function (error:any, res:any) {\n  //         if (error) {\n  //           // console.error(err);\n  //           // return reject(err);\n  //           return reject(error);\n  //         } else if (res.statusCode === 200) {\n  //           return resolve(res.body);\n  //           // return access token valid for 3 months\n  //         } else {\n  //           // return reject(res);\n  //           return reject(res);\n  //         }\n  //       }\n  //     );\n  //   });\n  // };\n\n  /**\n   *  Sign in the user upon button click.\n   */\n\n\n  function handleAuthClick(event) {\n    // Granting access when the user is offline\n    gapi.client.init({\n      apiKey: config.config.apiKey,\n      clientId: config.config.clientId,\n      discoveryDocs: config.config.discoveryDocs,\n      scope: config.config.scope\n    }).then(() => {\n      gapi.auth2.getAuthInstance().grantOfflineAccess().then(function (response) {\n        //auth code? not refresh token\n        setRefreshToken(response.code);\n        gapi.auth2.getAuthInstance().signIn(); // setAuthcode(\n        //   gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse()\n        //     .access_token\n        // );\n\n        console.log(\"my refresh token: \" + refreshToken);\n\n        if (response.code) {\n          // Hide the sign-in button now that the user is authorized, for example:\n          setAuthorizeButton(\"none\"); //$(\"#signinButton\").attr(\"style\", \"display: none\");\n\n          console.log(\"response code: \");\n          console.log(response);\n          setAuthcode(response.code);\n          console.log(\"After host added/found\"); // Send the code to the server\n          // getter.ajax({\n          //   type: \"POST\",\n          //   url: \"http://example.com/storeauthcode\",\n          //   // Always include an `X-Requested-With` header in every AJAX request,\n          //   // to protect against CSRF attacks.\n          //   headers: {\n          //     \"X-Requested-With\": \"XMLHttpRequest\",\n          //   },\n          //   contentType: \"application/octet-stream; charset=utf-8\",\n          //   success: function (result: any) {\n          //     // Handle or verify the server response.\n          //   },\n          //   processData: false,\n          //   data: response[\"code\"],\n          // });\n        } else {\n          // THERE WAS AN ERROR\n          console.log(\"THERE WAS AN ERROR\");\n        }\n      }); //gapi.auth2.getAuthInstance().signIn();\n    });\n  }\n  /**\n   *  Sign out the user upon button click.\n   */\n\n\n  function handleSignoutClick(event) {\n    gapi.auth2.getAuthInstance().signOut();\n  } //calendar.settings.readonly scope allowed\n\n  /**\n   *  Called when the signed in status changes, to update the UI\n   *  appropriately. After a sign-in, the API is called.\n   */\n\n\n  function updateSigninStatus(isSignedIn) {\n    if (isSignedIn) {\n      setAuthorizeButton(\"none\");\n      setSignoutButton(\"\"); //setSignoutButton(\"block\");\n\n      setIsSigned(true);\n      setName(gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getName());\n      setFname(gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getGivenName());\n      setLname(gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getFamilyName());\n      setEmail(gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getEmail());\n      setPicUrl(gapi.auth2.getAuthInstance().currentUser.get().getBasicProfile().getImageUrl());\n      setAuthcode(gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token);\n      setRefreshToken(refreshToken);\n      console.log(email);\n      console.log(fname);\n      console.log(lname);\n      listUpcomingEvents();\n      console.log(\"SIGNED IN\");\n    } else {\n      console.log(\"SIGNED OUT\");\n      setIsSigned(false);\n      setName(\"\");\n      setPicUrl(\"\");\n      setFname(\"\");\n      setLname(\"\");\n      setEmail(\"\");\n      setAuthorizeButton(\"\"); //setAuthorizeButton(\"block\");\n\n      setSignoutButton(\"none\");\n    }\n  } // /**\n  //  * Append a pre element to the body containing the given message\n  //  * as its text node. Used to display the results of the API call.\n  //  *\n  //  * @param {string} message Text to be placed in pre element.\n  //  */\n\n\n  function appendPre(message) {\n    const pre = document.getElementById(\"content\");\n    const textContent = document.createTextNode(message + \"\\n\");\n    pre.appendChild(textContent);\n  }\n\n  const CalendarCard = styled.div`\n    margin: 0 auto;\n    width: 1000px;\n    height: 800px;\n    align-items: center;\n    border-radius: 15px;\n  `;\n  /**\n   * Print the summary and start datetime/date of the next ten events in\n   * the authorized user's calendar. If no events are found an\n   * appropriate message is printed.\n   */\n\n  function listUpcomingEvents() {\n    gapi.client.calendar.events.list({\n      calendarId: \"primary\",\n      timeMin: new Date().toISOString(),\n      showDeleted: false,\n      singleEvents: true,\n      maxResults: 10,\n      orderBy: \"startTime\"\n    }).then(function (response) {\n      const events = response.result.items;\n      const appointments = response.result.items;\n\n      if (appointments.length > 0) {\n        for (let j = 0; j < appointments.length; j++) {\n          appointments[j].start = moment.utc(appointments[j].start.dateTime).toDate();\n          appointments[j].end = moment.utc(appointments[j].end.dateTime).toDate(); // appointments[j].start = moment\n          //   .utc(appointments[j].end.dateTime)\n          //   .toDate();\n          // appointments[j].end = moment\n          //   .utc(appointments[j].start.dateTime)\n          //   .toDate();\n        }\n\n        setMyEvents(appointments);\n      } //setMyEvents(events);\n      // debugger;\n\n\n      const tmp = message;\n      setMessage(tmp + \"Upcoming events:\" + \"\\n\"); // message += \"Upcoming events:\" + \"\\n\";\n\n      appendPre(\"Upcoming events:\");\n      console.log(events.length);\n\n      if (events.length > 0) {\n        let i;\n\n        for (i = 0; i < events.length; i++) {\n          let event = events[i];\n          let when = event.start.dateTime;\n\n          if (!when) {\n            when = event.start.date;\n          }\n\n          const temp = message + event.summary + \" (\" + when + \")\" + \"\\n\";\n          setMessage(temp); // message += temp;\n          // appendPre(event.summary + \" (\" + when + \")\");\n        }\n      } else {\n        setMessage(\"No upcoming events found.\" + \"\\n\"); // message += \"No upcoming events found.\" + \"\\n\";\n\n        appendPre(\"No upcoming events found.\");\n      }\n    });\n  } // handleClientLoad();\n\n\n  const LogoCard = styled.img`\n    width: 450px;\n    height: 100px;\n    justify-content: space-around;\n    float: left;\n    // text-align: center;\n    // resizemode: \"contain\";\n    // left: 50%;\n    // transform: translate(-50%, -50%);\n  `;\n  const TopFormat = styled.div`\n    margin: 0 auto;\n    width: 100%;\n    overflow: auto;\n    display: inline-block;\n    background: white;\n    border-radius: 25px;\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 10px;\n  `;\n  const HomePageFormat = styled.div`\n    margin: 0 auto;\n    align-items: center;\n    justify-content: center;\n    background: white;\n    display: flex;\n    flex-direction: column;\n    height: 1000px;\n    text-align: center;\n  `;\n  const WelcomeFormat = styled.div`\n    margin: 0 auto;\n    align-items: center;\n    justify-content: center;\n    background: white;\n    display: flex;\n    flex-direction: column;\n    height: 650px;\n    text-align: center;\n  `; //TODO take out\n  //console.log(accesstoken);\n\n  console.log(refreshToken);\n  return /*#__PURE__*/React.createElement(\"body\", {\n    style: {\n      background: \"rgba(131, 196, 197)\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 427,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      padding: \"1rem\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 428,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(TopFormat, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 429,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 430,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(LogoCard, {\n    id: \"logo\",\n    src: logo,\n    alt: \"Meeting Ground Logo\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 431,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-primary\",\n    id: \"authorize_button\",\n    onClick: handleAuthClick,\n    style: {\n      height: \"30%\",\n      justifyContent: \"center\",\n      alignSelf: \"center\",\n      display: authorizeButton,\n      float: \"right\",\n      margin: 30\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 433,\n      columnNumber: 13\n    }\n  }, \"Sign in\"), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"btn btn-danger\",\n    id: \"signout_button\",\n    onClick: handleSignoutClick,\n    style: {\n      height: \"30%\",\n      justifyContent: \"center\",\n      alignContent: \"center\",\n      display: signoutButton,\n      float: \"right\",\n      margin: 30\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 13\n    }\n  }, \"Sign Out\")), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      justifyContent: \"center\",\n      alignContent: \"center\",\n      display: \"flex\",\n      flexDirection: \"row\",\n      borderTop: \"5px solid grey\",\n      margin: 5\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 464,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    style: {\n      // position: \"relative\",\n      //width: 200,\n      margin: 0,\n      // float: \"left\",\n      // left: \"15%\",\n      justifyContent: \"center\",\n      top: 20\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 474,\n      columnNumber: 13\n    }\n  }, \"Main Page\"))), !isSigned && /*#__PURE__*/React.createElement(TopFormat, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 491,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(WelcomeFormat, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 492,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 493,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 494,\n      columnNumber: 17\n    }\n  }, \"HELLO!\"), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 496,\n      columnNumber: 17\n    }\n  }, \" Please sign in to use Meeting Ground\")))), isSigned && /*#__PURE__*/React.createElement(TopFormat, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 503,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(HomePageFormat, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 504,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    style: {\n      margin: 25\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 505,\n      columnNumber: 15\n    }\n  }, \"Welcome \", name), /*#__PURE__*/React.createElement(\"img\", {\n    src: picUrl,\n    alt: \"Avatar.\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 512,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      margin: 20,\n      display: \"flex\",\n      flexDirection: \"column\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 513,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    to: \"/home\",\n    className: \"btn btn-success\",\n    type: \"button\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 516,\n      columnNumber: 17\n    }\n  }, \"Continue to Meeting Ground Home\")), /*#__PURE__*/React.createElement(\"h3\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 520,\n      columnNumber: 15\n    }\n  }, \"Your upcoming events: \"), /*#__PURE__*/React.createElement(\"pre\", {\n    id: \"content\",\n    style: {\n      height: 100\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 521,\n      columnNumber: 15\n    }\n  }), /*#__PURE__*/React.createElement(CalendarCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 527,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(MyCalendar, {\n    myList: myEvents,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 528,\n      columnNumber: 17\n    }\n  }))))));\n};\n\nexport default ConnectPage;","map":{"version":3,"sources":["/Users/kimberlyzhu/Documents/MeetingGround/src/calendar/connect.tsx"],"names":["React","useState","useEffect","config","moment","MyCalendar","styled","logo","Link","useMutation","gql","AppendHostToDB","ConnectPage","isSigned","setIsSigned","name","setName","picUrl","setPicUrl","refreshToken","setRefreshToken","email","setEmail","fname","setFname","lname","setLname","auth_code","setAuthcode","message","setMessage","myEvents","setMyEvents","authorizeButton","setAuthorizeButton","signoutButton","setSignoutButton","mutate","addHostToDb","arg","variables","console","log","then","catch","err","gapi","load","initClient","client","init","apiKey","clientId","discoveryDocs","scope","auth2","getAuthInstance","isSignedIn","listen","updateSigninStatus","get","error","appendPre","JSON","stringify","handleAuthClick","event","grantOfflineAccess","response","code","signIn","handleSignoutClick","signOut","currentUser","getBasicProfile","getName","getGivenName","getFamilyName","getEmail","getImageUrl","getAuthResponse","access_token","listUpcomingEvents","pre","document","getElementById","textContent","createTextNode","appendChild","CalendarCard","div","calendar","events","list","calendarId","timeMin","Date","toISOString","showDeleted","singleEvents","maxResults","orderBy","result","items","appointments","length","j","start","utc","dateTime","toDate","end","tmp","i","when","date","temp","summary","LogoCard","img","TopFormat","HomePageFormat","WelcomeFormat","background","padding","height","justifyContent","alignSelf","display","float","margin","alignContent","flexDirection","borderTop","top"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport * as config from \"../apiGoogleconfig.json\";\nimport moment from \"moment\";\nimport MyCalendar from \"../pages/Moment\";\nimport styled from \"@emotion/styled\";\nimport \"react-big-calendar/lib/css/react-big-calendar.css\";\nimport logo from \"../pages/img/meetingGroundLogo.png\";\nimport { Link } from \"react-router-dom\";\nimport { useMutation } from \"react-apollo\";\nimport { gql } from \"apollo-boost\";\n\n//yarn add @types/gapi\n//yarn add @types/gapi.auth2\n//yarn add @types/gapi.client.calendar\n\nconst AppendHostToDB = gql`\n  mutation addHost(\n    $fname: String!\n    $lname: String!\n    $email: String!\n    $auth_code: String!\n  ) {\n    addHost(\n      Fname: $fname\n      Lname: $lname\n      email: $email\n      auth_code: $auth_code\n    ) {\n      Lname\n      email\n    }\n  }\n`;\n\nconst ConnectPage = () => {\n  const [isSigned, setIsSigned] = useState(false);\n  const [name, setName] = useState(\"\");\n  const [picUrl, setPicUrl] = useState(\"\");\n  const [refreshToken, setRefreshToken] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const [fname, setFname] = useState(\"\");\n  const [lname, setLname] = useState(\"\");\n  const [auth_code, setAuthcode] = useState(\"\"); //user Google Offline Access code\n  const [message, setMessage] = useState(\"\");\n  const [myEvents, setMyEvents] = useState<any[]>([]);\n  const [authorizeButton, setAuthorizeButton] = useState(\"\");\n  const [signoutButton, setSignoutButton] = useState(\"\");\n  const [mutate] = useMutation(AppendHostToDB);\n\n  useEffect(() => {\n    async function addHostToDb() {\n      // auth_code --> Google Offline Access code\n      const arg = await mutate({\n        variables: {\n          fname: fname,\n          lname: lname,\n          email: email,\n          auth_code: auth_code,\n        },\n      });\n      console.log(arg);\n    }\n    if (auth_code && fname && lname && email) {\n      addHostToDb()\n        .then(() => {\n          console.log(\"appended successfully\");\n        })\n        .catch((err) => {\n          console.log(\"an error happened\");\n        });\n    }\n  }, [auth_code, fname, lname, email, mutate]);\n\n  /**\n   *  On load, called to load the auth2 library and API client library.\n   */\n  useEffect(() => {\n    gapi.load(\"client:auth2\", initClient);\n  }, []);\n\n  // --> [] call the function only one time at the beginning\n  // function handleClientLoad() {\n  //   gapi.load(\"client:auth2\", initClient);\n  // }\n\n  /**\n   *  Initializes the API client library and sets up sign-in state\n   *  listeners.\n   */\n  function initClient() {\n    gapi.client\n      .init({\n        apiKey: config.config.apiKey,\n        clientId: config.config.clientId,\n        discoveryDocs: config.config.discoveryDocs,\n        scope: config.config.scope,\n      })\n      .then(\n        function () {\n          // Listen for sign-in state changes.\n          gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);\n\n          // Handle the initial sign-in state.\n          updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());\n          //authorizeButton.onclick = handleAuthClick;\n          //signoutButton.onclick = handleSignoutClick;\n        },\n        function (error: any) {\n          // setMessage(JSON.stringify(error, null, 2));\n          // const temp: string = JSON.stringify(error, null, 2);\n          // message += temp;\n          appendPre(JSON.stringify(error, null, 2));\n        }\n      );\n  }\n\n  //get refresh tokens\n  // const getRefreshTokenFromGoogleServices = (authCode: any) => {\n  //   return new Promise((resolve, reject) => {\n  //     var jsonRequest = {\n  //       client_id: config.config.clientId,\n  //       client_secret: config.config.clientSecret,\n  //       code: authCode,\n  //       grant_type: \"authorization_code\",\n  //       redirect_uri: \"postmessage\",\n  //     };\n  //     console.log(jsonRequest);\n  //     request(\n  //       {\n  //         url: \"https://accounts.google.com/o/oauth2/token\",\n  //         method: \"POST\",\n  //         headers: [{ name: \"Content-Type\", value: \"application/json\" }],\n  //         body: jsonRequest,\n  //         json: true,\n  //       },\n  //       function (error:any, res:any) {\n  //         if (error) {\n  //           // console.error(err);\n  //           // return reject(err);\n  //           return reject(error);\n  //         } else if (res.statusCode === 200) {\n  //           return resolve(res.body);\n  //           // return access token valid for 3 months\n  //         } else {\n  //           // return reject(res);\n  //           return reject(res);\n  //         }\n  //       }\n  //     );\n  //   });\n  // };\n\n  /**\n   *  Sign in the user upon button click.\n   */\n  function handleAuthClick(event: any) {\n    // Granting access when the user is offline\n    gapi.client\n      .init({\n        apiKey: config.config.apiKey,\n        clientId: config.config.clientId,\n        discoveryDocs: config.config.discoveryDocs,\n        scope: config.config.scope,\n      })\n      .then(() => {\n        gapi.auth2\n          .getAuthInstance()\n          .grantOfflineAccess()\n          .then(function (response: any) {\n            //auth code? not refresh token\n            setRefreshToken(response.code);\n            gapi.auth2.getAuthInstance().signIn();\n            // setAuthcode(\n            //   gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse()\n            //     .access_token\n            // );\n\n            console.log(\"my refresh token: \" + refreshToken);\n            if (response.code) {\n              // Hide the sign-in button now that the user is authorized, for example:\n              setAuthorizeButton(\"none\");\n              //$(\"#signinButton\").attr(\"style\", \"display: none\");\n              console.log(\"response code: \");\n              console.log(response);\n              setAuthcode(response.code);\n              console.log(\"After host added/found\");\n\n              // Send the code to the server\n              // getter.ajax({\n              //   type: \"POST\",\n              //   url: \"http://example.com/storeauthcode\",\n              //   // Always include an `X-Requested-With` header in every AJAX request,\n              //   // to protect against CSRF attacks.\n              //   headers: {\n              //     \"X-Requested-With\": \"XMLHttpRequest\",\n              //   },\n              //   contentType: \"application/octet-stream; charset=utf-8\",\n              //   success: function (result: any) {\n              //     // Handle or verify the server response.\n              //   },\n              //   processData: false,\n              //   data: response[\"code\"],\n              // });\n            } else {\n              // THERE WAS AN ERROR\n              console.log(\"THERE WAS AN ERROR\");\n            }\n          });\n        //gapi.auth2.getAuthInstance().signIn();\n      });\n  }\n\n  /**\n   *  Sign out the user upon button click.\n   */\n  function handleSignoutClick(event: any) {\n    gapi.auth2.getAuthInstance().signOut();\n  }\n\n  //calendar.settings.readonly scope allowed\n  /**\n   *  Called when the signed in status changes, to update the UI\n   *  appropriately. After a sign-in, the API is called.\n   */\n  function updateSigninStatus(isSignedIn: boolean) {\n    if (isSignedIn) {\n      setAuthorizeButton(\"none\");\n      setSignoutButton(\"\");\n      //setSignoutButton(\"block\");\n      setIsSigned(true);\n      setName(\n        gapi.auth2\n          .getAuthInstance()\n          .currentUser.get()\n          .getBasicProfile()\n          .getName()\n      );\n      setFname(\n        gapi.auth2\n          .getAuthInstance()\n          .currentUser.get()\n          .getBasicProfile()\n          .getGivenName()\n      );\n      setLname(\n        gapi.auth2\n          .getAuthInstance()\n          .currentUser.get()\n          .getBasicProfile()\n          .getFamilyName()\n      );\n      setEmail(\n        gapi.auth2\n          .getAuthInstance()\n          .currentUser.get()\n          .getBasicProfile()\n          .getEmail()\n      );\n      setPicUrl(\n        gapi.auth2\n          .getAuthInstance()\n          .currentUser.get()\n          .getBasicProfile()\n          .getImageUrl()\n      );\n      setAuthcode(\n        gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse()\n          .access_token\n      );\n      setRefreshToken(refreshToken);\n\n      console.log(email);\n      console.log(fname);\n      console.log(lname);\n      listUpcomingEvents();\n      console.log(\"SIGNED IN\");\n    } else {\n      console.log(\"SIGNED OUT\");\n      setIsSigned(false);\n      setName(\"\");\n      setPicUrl(\"\");\n      setFname(\"\");\n      setLname(\"\");\n      setEmail(\"\");\n      setAuthorizeButton(\"\");\n      //setAuthorizeButton(\"block\");\n      setSignoutButton(\"none\");\n    }\n  }\n\n  // /**\n  //  * Append a pre element to the body containing the given message\n  //  * as its text node. Used to display the results of the API call.\n  //  *\n  //  * @param {string} message Text to be placed in pre element.\n  //  */\n  function appendPre(message: string) {\n    const pre = document.getElementById(\"content\") as HTMLElement;\n    const textContent = document.createTextNode(message + \"\\n\");\n    pre.appendChild(textContent);\n  }\n\n  const CalendarCard = styled.div`\n    margin: 0 auto;\n    width: 1000px;\n    height: 800px;\n    align-items: center;\n    border-radius: 15px;\n  `;\n\n  /**\n   * Print the summary and start datetime/date of the next ten events in\n   * the authorized user's calendar. If no events are found an\n   * appropriate message is printed.\n   */\n  function listUpcomingEvents() {\n    gapi.client.calendar.events\n      .list({\n        calendarId: \"primary\",\n        timeMin: new Date().toISOString(),\n        showDeleted: false,\n        singleEvents: true,\n        maxResults: 10,\n        orderBy: \"startTime\",\n      })\n      .then(function (response: any) {\n        const events: any[] = response.result.items;\n        const appointments = response.result.items;\n        if (appointments.length > 0) {\n          for (let j = 0; j < appointments.length; j++) {\n            appointments[j].start = moment\n              .utc(appointments[j].start.dateTime)\n              .toDate();\n            appointments[j].end = moment\n              .utc(appointments[j].end.dateTime)\n              .toDate();\n            // appointments[j].start = moment\n            //   .utc(appointments[j].end.dateTime)\n            //   .toDate();\n            // appointments[j].end = moment\n            //   .utc(appointments[j].start.dateTime)\n            //   .toDate();\n          }\n          setMyEvents(appointments);\n        }\n\n        //setMyEvents(events);\n        // debugger;\n        const tmp: string = message;\n        setMessage(tmp + \"Upcoming events:\" + \"\\n\");\n        // message += \"Upcoming events:\" + \"\\n\";\n        appendPre(\"Upcoming events:\");\n        console.log(events.length);\n        if (events.length > 0) {\n          let i: number;\n          for (i = 0; i < events.length; i++) {\n            let event = events[i];\n            let when = event.start.dateTime;\n            if (!when) {\n              when = event.start.date;\n            }\n            const temp: string =\n              message + event.summary + \" (\" + when + \")\" + \"\\n\";\n            setMessage(temp);\n            // message += temp;\n            // appendPre(event.summary + \" (\" + when + \")\");\n          }\n        } else {\n          setMessage(\"No upcoming events found.\" + \"\\n\");\n          // message += \"No upcoming events found.\" + \"\\n\";\n          appendPre(\"No upcoming events found.\");\n        }\n      });\n  }\n\n  // handleClientLoad();\n\n  const LogoCard = styled.img`\n    width: 450px;\n    height: 100px;\n    justify-content: space-around;\n    float: left;\n    // text-align: center;\n    // resizemode: \"contain\";\n    // left: 50%;\n    // transform: translate(-50%, -50%);\n  `;\n\n  const TopFormat = styled.div`\n    margin: 0 auto;\n    width: 100%;\n    overflow: auto;\n    display: inline-block;\n    background: white;\n    border-radius: 25px;\n    display: flex;\n    flex-direction: column;\n    margin-bottom: 10px;\n  `;\n\n  const HomePageFormat = styled.div`\n    margin: 0 auto;\n    align-items: center;\n    justify-content: center;\n    background: white;\n    display: flex;\n    flex-direction: column;\n    height: 1000px;\n    text-align: center;\n  `;\n\n  const WelcomeFormat = styled.div`\n    margin: 0 auto;\n    align-items: center;\n    justify-content: center;\n    background: white;\n    display: flex;\n    flex-direction: column;\n    height: 650px;\n    text-align: center;\n  `;\n\n  //TODO take out\n  //console.log(accesstoken);\n  console.log(refreshToken);\n  return (\n    <body style={{ background: \"rgba(131, 196, 197)\" }}>\n      <div style={{ padding: \"1rem\" }}>\n        <TopFormat>\n          <div>\n            <LogoCard id=\"logo\" src={logo} alt=\"Meeting Ground Logo\" />\n\n            <button\n              className=\"btn btn-primary\"\n              id=\"authorize_button\"\n              onClick={handleAuthClick}\n              style={{\n                height: \"30%\",\n                justifyContent: \"center\",\n                alignSelf: \"center\",\n                display: authorizeButton,\n                float: \"right\",\n                margin: 30,\n              }}\n            >\n              Sign in\n            </button>\n            <button\n              className=\"btn btn-danger\"\n              id=\"signout_button\"\n              onClick={handleSignoutClick}\n              style={{\n                height: \"30%\",\n                justifyContent: \"center\",\n                alignContent: \"center\",\n                display: signoutButton,\n                float: \"right\",\n                margin: 30,\n              }}\n            >\n              Sign Out\n            </button>\n          </div>\n          <div\n            style={{\n              justifyContent: \"center\",\n              alignContent: \"center\",\n              display: \"flex\",\n              flexDirection: \"row\",\n              borderTop: \"5px solid grey\",\n              margin: 5,\n            }}\n          >\n            <h1\n              style={{\n                // position: \"relative\",\n                //width: 200,\n                margin: 0,\n                // float: \"left\",\n                // left: \"15%\",\n                justifyContent: \"center\",\n                top: 20,\n              }}\n            >\n              Main Page\n            </h1>\n          </div>\n        </TopFormat>\n\n        {!isSigned && (\n          <TopFormat>\n            <WelcomeFormat>\n              <div>\n                <h1>HELLO!</h1>\n\n                <h3> Please sign in to use Meeting Ground</h3>\n              </div>\n            </WelcomeFormat>\n          </TopFormat>\n        )}\n\n        {isSigned && (\n          <TopFormat>\n            <HomePageFormat>\n              <h1\n                style={{\n                  margin: 25,\n                }}\n              >\n                Welcome {name}\n              </h1>\n              <img src={picUrl} alt=\"Avatar.\" />\n              <div\n                style={{ margin: 20, display: \"flex\", flexDirection: \"column\" }}\n              >\n                <Link to=\"/home\" className=\"btn btn-success\" type=\"button\">\n                  Continue to Meeting Ground Home\n                </Link>\n              </div>\n              <h3>Your upcoming events: </h3>\n              <pre\n                id=\"content\"\n                style={{\n                  height: 100,\n                }}\n              ></pre>\n              <CalendarCard>\n                <MyCalendar myList={myEvents} />\n              </CalendarCard>\n            </HomePageFormat>\n          </TopFormat>\n        )}\n      </div>\n    </body>\n  );\n};\nexport default ConnectPage;\n"]},"metadata":{},"sourceType":"module"}